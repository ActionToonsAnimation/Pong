<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Pong Game</title>
  <style>
    canvas {
      display: block;
      margin: 0 auto;
    }
    body {
      text-align: center;
      color: white;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <h1>Simple Pong Game</h1>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Paddle properties
    const paddleWidth = 10;
    const paddleHeight = 100;
    const playerSpeed = 8;

    // Images
    const backgroundImg = new Image();
    backgroundImg.src = 'https://actiontoonsanimation.github.io/Pong/background.png';
    const paddleImg = new Image();
    paddleImg.src = 'https://actiontoonsanimation.github.io/Pong/paddle.png';
    const ballImg = new Image();
    ballImg.src = 'https://actiontoonsanimation.github.io/Pong/ball.png';

    // Sound effects
    const hitSound = new Audio('hit.wav');
    const backgroundMusic = new Audio('level1music.wav');
    backgroundMusic.volume = 0.5;
    backgroundMusic.loop = true;

    let player1Y = canvas.height / 2 - paddleHeight / 2;
    let player2Y = canvas.height / 2 - paddleHeight / 2;
    let computerSpeed = 4;

    // Ball properties
    let ballX = canvas.width / 2;
    let ballY = canvas.height / 2;
    let ballSpeedX = 4;
    let ballSpeedY = 4;
    const ballRadius = 10;

    // Scores
    let player1Score = 0;
    let player2Score = 0;

    // Controls
    let upPressed = false;
    let downPressed = false;

    // Ensure background image is loaded before starting the game loop
    backgroundImg.onload = () => {
      gameLoop();
    };

    function draw() {
      // Clear the canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the background
      ctx.drawImage(backgroundImg, 0, 0, canvas.width, canvas.height);

      // Draw player 1 paddle
      ctx.drawImage(paddleImg, 0, player1Y, paddleWidth, paddleHeight);

      // Draw player 2 paddle
      ctx.drawImage(paddleImg, canvas.width - paddleWidth, player2Y, paddleWidth, paddleHeight);

      // Draw the ball
      ctx.drawImage(ballImg, ballX - ballRadius, ballY - ballRadius, ballRadius * 2, ballRadius * 2);

      // Draw scores
      ctx.fillStyle = 'white';
      ctx.font = '20px Arial';
      ctx.fillText('Player 1: ' + player1Score, 20, 30);
      ctx.fillText('AI: ' + player2Score, canvas.width - 100, 30);
    }

    function update() {
      // Move player 1 paddle
      if (upPressed && player1Y > 0) {
        player1Y -= playerSpeed;
      } else if (downPressed && player1Y < canvas.height - paddleHeight) {
        player1Y += playerSpeed;
      }

      // Move player 2 paddle (computer AI) with unpredictability
      const randomFactor = Math.random();
      if (ballY < player2Y + paddleHeight / 2 && player2Y > 0) {
        player2Y -= computerSpeed * (1 + randomFactor * 0.5);
      } else if (ballY > player2Y + paddleHeight / 2 && player2Y < canvas.height - paddleHeight) {
        player2Y += computerSpeed * (1 + randomFactor * 0.5);
      }

      // Add randomness to AI mistakes
      if (randomFactor < 0.1) {
        player2Y += computerSpeed * (Math.random() > 0.5 ? 1 : -1);
      }

      // Move the ball
      ballX += ballSpeedX;
      ballY += ballSpeedY;

      // Ball collision with top and bottom
      if (ballY - ballRadius < 0 || ballY + ballRadius > canvas.height) {
        ballSpeedY = -ballSpeedY;
        hitSound.play();
      }

      // Ball collision with paddles
      if (
        (ballX - ballRadius < paddleWidth && ballY > player1Y && ballY < player1Y + paddleHeight) ||
        (ballX + ballRadius > canvas.width - paddleWidth && ballY > player2Y && ballY < player2Y + paddleHeight)
      ) {
        ballSpeedX = -ballSpeedX * (1 + (Math.random() - 0.5) * 0.1);
        hitSound.play();
      }

      // Ball out of bounds (reset to middle and update score)
      if (ballX < 0) {
        player2Score++;
        resetBall();
      } else if (ballX > canvas.width) {
        player1Score++;
        resetBall();
      }
    }

    function resetBall() {
      ballX = canvas.width / 2;
      ballY = canvas.height / 2;
      ballSpeedX = -ballSpeedX;
    }

    function gameLoop() {
      draw();
      update();
      requestAnimationFrame(gameLoop);
    }

    // Start background music on user interaction
    canvas.addEventListener('click', () => {
      backgroundMusic.play();
    });

    // Event listeners for controls
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowUp') upPressed = true;
      if (e.key === 'ArrowDown') downPressed = true;
    });

    document.addEventListener('keyup', (e) => {
      if (e.key === 'ArrowUp') upPressed = false;
      if (e.key === 'ArrowDown') downPressed = false;
    });
  </script>
</body>
</html>
