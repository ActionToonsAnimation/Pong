<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Pong Game</title>
  <style>
    @font-face {
      font-family: 'ArcadeClassic';
      src: url('ARCADECLASSIC.TTF') format('truetype');
    }
    canvas {
      display: block;
      margin: 0 auto;
      border: 10px solid #00f; /* Thick neon blue border */
      border-color: #00f; /* Neon blue border */
    }
    body {
      text-align: center;
      color: white;
      font-family: 'ArcadeClassic', Arial, sans-serif;
      background-color: black;
    }
  </style>
</head>
<body>
  <h1>Simple Pong Game</h1>
  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    // Paddle properties
    const paddleWidth = 10;
    const paddleHeight = 100;
    const playerSpeed = 5;
    let player1Velocity = 0;
    const friction = 0.8; // Friction for easing paddle to a stop

    // Images
    const paddleImg = new Image();
    paddleImg.src = 'https://actiontoonsanimation.github.io/Pong/paddle.png';
    paddleImg.onload = () => checkAssetsLoaded();
    paddleImg.onerror = () => console.error('Paddle image failed to load');

    const ballImg = new Image();
    ballImg.src = 'https://actiontoonsanimation.github.io/Pong/ball.png';
    ballImg.onload = () => checkAssetsLoaded();
    ballImg.onerror = () => console.error('Ball image failed to load');

    const backgroundImg = new Image();
    backgroundImg.src = 'https://actiontoonsanimation.github.io/Pong/background.png';
    backgroundImg.onload = () => checkAssetsLoaded();
    backgroundImg.onerror = () => console.error('Background image failed to load');

    // Sound effects
    const hitSound = new Audio('https://actiontoonsanimation.github.io/Pong/hit.wav');
    hitSound.volume = 0.5;
    hitSound.oncanplaythrough = () => checkAssetsLoaded();
    hitSound.onerror = () => console.error('Hit sound failed to load');

    const loseSound = new Audio('https://actiontoonsanimation.github.io/Pong/lose.wav');
    loseSound.oncanplaythrough = () => checkAssetsLoaded();
    loseSound.onerror = () => console.error('Lose sound failed to load');

    const winSound = new Audio('https://actiontoonsanimation.github.io/Pong/win.wav');
    winSound.oncanplaythrough = () => checkAssetsLoaded();
    winSound.onerror = () => console.error('Win sound failed to load');

    const backgroundMusic = new Audio('https://actiontoonsanimation.github.io/Pong/level1music.wav');
    backgroundMusic.volume = 0.5;
    backgroundMusic.loop = true;
    backgroundMusic.onerror = () => console.error('Background music failed to load');

    let assetsLoaded = 0;
    const totalAssets = 6; // Number of image and audio assets

    let player1Y = canvas.height / 2 - paddleHeight / 2;
    let player2Y = canvas.height / 2 - paddleHeight / 2;
    let computerSpeed = 2.5;

    // Ball properties
    let ballX = canvas.width / 2;
    let ballY = canvas.height / 2;
    let ballSpeedX = 2.5;
    let ballSpeedY = 2.5;
    const ballRadius = 10;

    // Scores
    let player1Score = 0;
    let player2Score = 0;

    // Controls
    let upPressed = false;
    let downPressed = false;

    // Flash the score of the losing player
    function flashScore(player) {
      let flashCount = 0;
      const flashInterval = setInterval(() => {
        document.querySelector('h1').style.color = flashCount % 2 === 0 ? 'red' : 'white';
        flashCount++;
        if (flashCount > 6) {
          clearInterval(flashInterval);
          document.querySelector('h1').style.color = 'white';
        }
      }, 500);
    }

    // Check if all assets are loaded
    function checkAssetsLoaded() {
      assetsLoaded++;
      if (assetsLoaded >= totalAssets) {
        backgroundMusic.play().catch((error) => { console.warn('Autoplay blocked: ', error); });
        gameLoop();
      }
    }

    function draw() {
      // Clear the canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the background
      if (backgroundImg.complete && backgroundImg.naturalWidth !== 0) {
        ctx.drawImage(backgroundImg, 0, 0);
      } else {
        ctx.fillStyle = 'black'; // Fallback background color
        ctx.fillRect(0, 0, canvas.width, canvas.height);
      }

      // Draw player 1 paddle
      if (paddleImg.complete && paddleImg.naturalWidth !== 0) {
        ctx.drawImage(paddleImg, 0, player1Y, paddleWidth, paddleHeight);
      } else {
        ctx.fillStyle = 'white';
        ctx.fillRect(0, player1Y, paddleWidth, paddleHeight);
      }

      // Draw player 2 paddle
      if (paddleImg.complete && paddleImg.naturalWidth !== 0) {
        ctx.drawImage(paddleImg, canvas.width - paddleWidth, player2Y, paddleWidth, paddleHeight);
      } else {
        ctx.fillStyle = 'white';
        ctx.fillRect(canvas.width - paddleWidth, player2Y, paddleWidth, paddleHeight);
      }

      // Draw the ball
      if (ballImg.complete && ballImg.naturalWidth !== 0) {
        ctx.drawImage(ballImg, ballX - ballRadius, ballY - ballRadius, ballRadius * 2, ballRadius * 2);
      } else {
        ctx.fillStyle = 'white';
        ctx.beginPath();
        ctx.arc(ballX, ballY, ballRadius, 0, Math.PI * 2);
        ctx.fill();
      }

      // Draw scores
      ctx.fillStyle = 'white';
      ctx.font = '20px ArcadeClassic, Arial, sans-serif';
      ctx.fillText('Player 1: ' + player1Score, 20, 30);
      ctx.fillText('AI: ' + player2Score, canvas.width - 100, 30);
    }

    function update() {
      // Move player 1 paddle
      if (upPressed && player1Y > 0) {
        player1Velocity = -playerSpeed;
      } else if (downPressed && player1Y < canvas.height - paddleHeight) {
        player1Velocity = playerSpeed;
      } else {
        player1Velocity *= friction;
      }
      player1Y += player1Velocity;

      // Move player 2 paddle (computer AI)
      if (ballY < player2Y + paddleHeight / 2 && player2Y > 0) {
        player2Y -= computerSpeed;
      } else if (ballY > player2Y + paddleHeight / 2 && player2Y < canvas.height - paddleHeight) {
        player2Y += computerSpeed;
      }

      // Move the ball
      ballX += ballSpeedX;
      ballY += ballSpeedY;

      // Ball collision with top and bottom
      if (ballY - ballRadius < 0 || ballY + ballRadius > canvas.height) {
        ballSpeedY = -ballSpeedY;
        hitSound.pause(); hitSound.currentTime = 0; hitSound.play();
      }

      // Ball collision with paddles
      if (
        (ballX - ballRadius < paddleWidth && ballY > player1Y && ballY < player1Y + paddleHeight) ||
        (ballX + ballRadius > canvas.width - paddleWidth && ballY > player2Y && ballY < player2Y + paddleHeight)
      ) {
        ballSpeedX = -ballSpeedX;
        hitSound.play();
      }

      // Ball out of bounds (reset to middle and update score)
      if (ballX < 0) {
        player2Score++;
        loseSound.play(); // AI scores
        flashScore('Player 1');
        resetBall();
      } else if (ballX > canvas.width) {
        player1Score++;
        winSound.play(); // Player scores
        flashScore('AI');
        resetBall();
      }
    }

    function resetBall() {
      ballX = canvas.width / 2;
      ballY = canvas.height / 2;
      ballSpeedX = -ballSpeedX;
    }

    function gameLoop() {
      draw();
      update();
      requestAnimationFrame(gameLoop);
    }

    // Event listeners for controls
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowUp') upPressed = true;
      if (e.key === 'ArrowDown') downPressed = true;
    });

    document.addEventListener('keyup', (e) => {
      if (e.key === 'ArrowUp') upPressed = false;
      if (e.key === 'ArrowDown') downPressed = false;
    });
  </script>
</body>
</html>
